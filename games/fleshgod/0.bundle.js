(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(t,r,n){"use strict";n.r(r),n.d(r,"default",function(){return Z});var e=n(0),a=n.n(e),i=n(2),o=n.n(i),u=n(25),s=n.n(u),c=n(3),f=n.n(c),l=n(5),h=n.n(l),d=n(43),v=n.n(d),p=n(44),m=n.n(p),x=n(45),b=n.n(x),y=n(46),M=n.n(y),E=n(47),T=n.n(E),g=n(48),R=n.n(g),A=n(49),F=n.n(A),S=n(50),w=n.n(S),_=n(51),D=n.n(_),B=n(52),U=n.n(B),I=n(53),C=n.n(I),O=n(23),P=n.n(O),N=n(24),z=n.n(N),L=n(54),X=n.n(L),G=n(55),q=n.n(G),H=n(56),j=n.n(H),Y=n(1),V=n(6),W=n(8),k=n(4);function Q(t){return[parseInt(t.substr(1,2),16)/255,parseInt(t.substr(3,2),16)/255,parseInt(t.substr(5,2),16)/255]}var Z=function(){function t(r,n){f()(this,t),this.alpha=1,this.z=0,this.gl=r,this.config=n,this.canvas=r.canvas,this.textCtx=r.canvas.ownerDocument.createElement("canvas").getContext("2d"),this.tris=0,this.coloredQuads=[],this.uiTris=2,this.boxes=[],this.lines=0,this.textures={},this.textures.empty={texture:null,size:null,uva:Object(Y.a)(0,0),uvb:Object(Y.a)(0,0)},this.gameQuadGroups=new Map,this.uiQuadGroups=new Map,this.shaderArgs=new Map}return h()(t,[{key:"drawQuad",value:function(t,r){var n,e=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=this.textures[t],c=u.texture,f=u.size,l=u.uva,h=u.uvb,d=i.alpha,v=void 0===d?this.alpha:d,p=i.transforms,m=void 0===p?[]:p,x=i.size,b=void 0===x?f:x,y=i.z,M=void 0===y?this.z:y,E=i.program,T=void 0===E?{type:"world"}:E,g=[{uvx:l.x,uvy:l.y,l:1},{uvx:l.x,uvy:h.y,l:1},{uvx:h.x,uvy:h.y,l:1},{uvx:h.x,uvy:l.y,l:1}],R=[r,Object(Y.a)(r.x,r.y+b.y),Object(Y.a)(r.x+b.x,r.y+b.y),Object(Y.a)(r.x+b.x,r.y)],A={flipX:function(){var t;return t=[g[3],g[2],g[1],g[0]],g[0]=t[0],g[1]=t[1],g[2]=t[2],g[3]=t[3],t},flipY:function(){var t;return t=[g[1],g[0],g[3],g[2]],g[0]=t[0],g[1]=t[1],g[2]=t[2],g[3]=t[3],t},scale:function(t){var r=t.x,n=t.y;return F(k.a.fromScaling(k.a.create(),[r,n]))},rotate:function(t){var r=t.angle;return F(k.a.fromRotation(k.a.create(),r))},matrix:function(t){var r=t.mat;return F(r)}},F=function(t){n||(n=r.clone().add(b.x/2,b.y/2));for(var e=0;e<R.length;e++){var a=R[e],i=k.c.transformMat3(k.c.create(),k.c.fromValues(a.x-n.x,a.y-n.y),t);a.x=n.x+i[0],a.y=n.y+i[1]}};if(m.length){var S=!0,w=!1,_=void 0;try{for(var D,B=m[Symbol.iterator]();!(S=(D=B.next()).done);S=!0){var U=D.value;"string"==typeof U?A[U]():A[U.type](U)}}catch(t){w=!0,_=t}finally{try{S||null==B.return||B.return()}finally{if(w)throw _}}}var I,C=T.type,O=s()(T,["type"]),P=this.programs[C].uniforms,N=P.screenSampler,z=P.screenTexBounds,L=s()(P,["screenSampler","screenTexBounds"]),X=JSON.stringify(Object.entries(T).sort(function(t,r){return o()(t,1)[0]-o()(r,1)[0]}));if(z||(I=this.shaderArgs.get(X)),I||(I={program:this.programs[C],uniforms:Object.assign(Object.entries(L).reduce(function(t,r){var n=o()(r,2),e=n[0],a=n[1].initial;return void 0!==a&&null!==a&&(t[e]=a),t},{}),O)},z||this.shaderArgs.set(X,I)),z){for(var G,q,H=function(t){var r=k.d.fromValues(R[t].x,R[t].y,0);k.d.transformMat4(r,r,e.view),k.d.transformMat4(r,r,e.projection);var n=r=r.slice(0,2).map(function(t,r){return(.5*t+.5)*e.fbScale[r%2?"y":"x"]}),a=o()(n,2);g[t].sx=a[0],g[t].sy=a[1],G?(G=G.map(function(t,n){return Math.min(t,r[n])}),q=q.map(function(t,n){return Math.max(t,r[n])})):G=q=[r[0],r[1]]},j=0;j<R.length;j++)H(j);I.uniforms.screenTexBounds=new Float32Array(a()(G).concat(a()(q)))}var V=this.gameQuadGroups.get(M)||new Map;V.size||this.gameQuadGroups.set(M,V);var W=V.get(I)||new Map;W.size||V.set(I,W);var Q=W.get(c)||[];Q.length||W.set(c,Q),Q.push({vs:R,ex:g,size:b,z:M,alpha:v}),this.tris+=2,N&&(this.tris+=2)}},{key:"drawUIQuad",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=this.textures[t],a=e.texture,i=e.size,o=e.uva,u=e.uvb,s=n.alpha,c=void 0===s?this.alpha:s,f=n.size,l=void 0===f?i:f,h=this.uiQuadGroups.get(a)||[];h.length||this.uiQuadGroups.set(a,h);var d={x:r.x+l.x,y:r.y+l.y};h.push({a:r,b:d,alpha:c,ex:[{x:o.x,y:o.y},{x:o.x,y:u.y},{x:u.x,y:u.y},{x:u.x,y:o.y}]}),this.uiTris+=2}},{key:"measureText",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V.e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V.d,e=this.textCtx;return e.font="".concat(r,"px ").concat(n),e.measureText(t)}},{key:"fillRect",value:function(t,r,n){var e=n.color,i=n.z,o=void 0===i?1:i,u=n.alpha,s=void 0===u?this.alpha:u;this.coloredQuads.push({a:t,b:t.clone().addV2(r),z:o,color:a()(Q(e)).concat([s])}),this.uiTris+=2}},{key:"strokeRect",value:function(t,r,n){var e=n.color,i=n.z,o=void 0===i?1:i,u=n.alpha,s=void 0===u?this.alpha:u;this.boxes.push({a:t.clone().add(.5,.5),b:t.clone().addV2(r).add(.5,.5),z:o,color:a()(Q(e)).concat([s])}),this.lines+=4}},{key:"drawText",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.size,e=void 0===n?V.e:n,a=r.family,i=void 0===a?V.d:a,o=r.y,u=void 0===o?0:o,s=r.x,c=void 0===s?0:s,f=r.z,l=void 0===f?2:f,h=r.key,d=void 0===h?null:h,v=r.shadow,p=void 0===v||v,m=r.color,x=void 0===m?"#ffffff":m,b=this.gl,y=this.textCtx,M=d?"k".concat(d):"s".concat(e,"t").concat(t,"c").concat(x),E=this.textTextures.get(M);y.font="".concat(e,"px ").concat(i);var T=y.measureText(t);E&&E.lastText===t&&E.lastHeight===e&&E.lastWidth===T.width||(E?b.bindTexture(b.TEXTURE_2D,E):(E=b.createTexture(),this.textTextures.set(M,E),E.groupId=65535,b.bindTexture(b.TEXTURE_2D,E),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),E.lastText=t,E.lastWidth=T.width,E.lastHeight=e,y.canvas.width=T.width+4,y.canvas.height=1.5*e,y.font="".concat(e,"px ").concat(i),y.fillStyle="rgba(0, 0, 0, 0)",y.fillRect(0,0,y.canvas.width,y.canvas.height),p&&(y.fillStyle="black",y.fillText(t,4,e+4)),y.fillStyle=x,y.fillText(t,0,e),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,y.canvas));var g=this.uiQuadGroups.get(E)||[];g.length||this.uiQuadGroups.set(E,g),g.push({a:Object(Y.a)(c,u-e),b:Object(Y.a)(c+T.width+4,u+.5*e),z:l,alpha:1,ex:[{x:0,y:0,l:1},{x:0,y:1,l:1},{x:1,y:1,l:1},{x:1,y:0,l:1}]}),this.uiTris+=2}},{key:"drawTextCentered",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.size,e=void 0===n?V.e:n,a=r.family,i=void 0===a?V.d:a,o=r.y,u=void 0===o?0:o,s=r.x,c=void 0===s?0:s,f=r.z,l=void 0===f?2:f,h=r.key,d=void 0===h?null:h,v=this.gl,p=this.measureText(t,e,i);this.drawText(t,{x:(v.canvas.width-p.width)/2+c,y:(v.canvas.height+e)/2+u,z:l,size:e,key:d})}},{key:"setUniform",value:function(t,r){var n=t.type,e=t.obj;"M"===n[0]?this.gl["uniform".concat(n)](e,!1,r):this.gl["uniform".concat(n)](e,r)}},{key:"setup",value:function(t){var r=this,n=this.gl,e=this.canvas;this.textTextures=new Map;var i=function(t,r,e){var a=n.createShader(r);return n.shaderSource(a,e),n.compileShader(a),n.getShaderParameter(a,n.COMPILE_STATUS)?a:(Object(W.a)("".concat(t,": ").concat(n.getShaderInfoLog(a))),null)},u=function(t){for(var e=t.name,u=t.shaders,s=t.uniforms,c=void 0===s?{}:s,f=t.attribs,l=void 0===f?[]:f,h=t.defines,d=void 0===h?{}:h,v=n.createProgram(),p=Object.entries(u),m=0;m<p.length;m++){var x=o()(p[m],2),b=x[0],y=x[1],M=y.type,E=y.src;n.attachShader(v,i("".concat(e," shader #").concat(b),M,a()(Object.entries(d).map(function(t){var r=o()(t,2),n=r[0],e=r[1];return"#define ".concat(n," ").concat(e)})).concat([E]).join("\n")))}if(n.linkProgram(v),n.validateProgram(v),n.getProgramParameter(v,n.LINK_STATUS)){v.uniforms={};var T=Object.entries(c);(T.length||l.length)&&n.useProgram(v);for(var g=0;g<T.length;g++){var R=o()(T[g],2),A=R[0],F=R[1],S=(M=F.type,F.initial),w=v.uniforms[A]={obj:n.getUniformLocation(v,A),type:M,initial:S};void 0!==S&&null!==S&&r.setUniform(w,S)}v.attribs={};var _=!0,D=!1,B=void 0;try{for(var U,I=l[Symbol.iterator]();!(_=(U=I.next()).done);_=!0){var C=U.value;v.attribs[C]=n.getAttribLocation(v,C)}}catch(t){D=!0,B=t}finally{try{_||null==I.return||I.return()}finally{if(D)throw B}}}else Object(W.a)("program ".concat(e,": ").concat(n.getProgramInfoLog(v)));return v},s=this.viewport=Object(Y.a)(e.width,e.height);n.viewport(0,0,s.x,s.y);var c=this.projection=k.b.ortho(k.b.create(),0,s.x,s.y,0,-4,4);this.programs={},this.programs.world=u({name:"world",shaders:[{type:n.VERTEX_SHADER,src:P.a},{type:n.FRAGMENT_SHADER,src:C.a}],uniforms:{projection:{type:"Matrix4fv",initial:c},view:{type:"Matrix4fv"},sampler:{type:"1i",initial:0}},attribs:["position","extra"]}),n.enableVertexAttribArray(this.programs.world.attribs.position),n.enableVertexAttribArray(this.programs.world.attribs.extra),this.programs.color=u({name:"color",shaders:[{type:n.VERTEX_SHADER,src:m.a},{type:n.FRAGMENT_SHADER,src:v.a}],uniforms:{projection:{type:"Matrix4fv",initial:c}},attribs:["position","extra"]}),this.programs.ui=u({name:"ui",shaders:[{type:n.VERTEX_SHADER,src:U.a},{type:n.FRAGMENT_SHADER,src:D.a}],uniforms:{projection:{type:"Matrix4fv",initial:c},sampler:{type:"1i",initial:0}},attribs:["position","extra"]});var f=s.clone().map(function(t){return Math.pow(2,Math.ceil(Math.log2(t)))});this.fbSize=f,this.fbScale=s.clone().divV2(f);var l=Object(Y.a)(1,1).divV2(f);this.programs.highlights=u({name:"highlights",shaders:[{type:n.VERTEX_SHADER,src:R.a},{type:n.FRAGMENT_SHADER,src:T.a}],uniforms:{fbScale:{type:"2fv",initial:new Float32Array(this.fbScale.array())},fb:{type:"1i",initial:0}},attribs:["position"]});for(var h=new Float32Array(13),d=0,p=1;p<=13;p++){var x=Math.exp(p*p/-128);h[p-1]=x,d+=x}for(var y=0;y<h.length;y++)h[y]/=2*d;this.programs.blur=u({name:"blur",shaders:[{type:n.VERTEX_SHADER,src:w.a},{type:n.FRAGMENT_SHADER,src:F.a}],defines:{KSIZE:13},uniforms:{fbScale:{type:"2fv",initial:new Float32Array(this.fbScale.array())},pixelSize:{type:"2fv",initial:new Float32Array(l.array())},blurWeights:{type:"1fv",initial:h},blurVector:{type:"2fv",initial:new Float32Array([1,0])},fb:{type:"1i",initial:0}},attribs:["position"]}),this.programs.screen=u({name:"screen",shaders:[{type:n.VERTEX_SHADER,src:M.a},{type:n.FRAGMENT_SHADER,src:b.a}],uniforms:{fbScale:{type:"2fv",initial:new Float32Array(this.fbScale.array())},hilightsScale:{type:"2fv",initial:new Float32Array(this.fbScale.array())},separation:{type:"2fv",initial:new Float32Array([0,0,0,0,0,0])},fb:{type:"1i",initial:0},hilights:{type:"1i",initial:1}},attribs:["position"]}),this.programs.glass=u({name:"glass",shaders:[{type:n.VERTEX_SHADER,src:z.a},{type:n.FRAGMENT_SHADER,src:X.a}],uniforms:{sampler:{type:"1i",initial:0},screenSampler:{type:"1i",initial:1},alpha:{type:"1f",initial:1},screenTexBounds:{type:"4fv"}},attribs:["position","extra"]}),this.programs.vsine=u({name:"vsine",shaders:[{type:n.VERTEX_SHADER,src:P.a},{type:n.FRAGMENT_SHADER,src:j.a}],uniforms:{fbSize:{type:"2fv",initial:new Float32Array(f.array())},fbScale:{type:"2fv",initial:new Float32Array(this.fbScale.array())},projection:{type:"Matrix4fv",initial:c},view:{type:"Matrix4fv"},sampler:{type:"1i",initial:0},phase:{type:"1f",initial:0},screenTexBounds:{type:"4fv"}},attribs:["position","extra"]}),this.programs.ripple=u({name:"ripple",shaders:[{type:n.VERTEX_SHADER,src:z.a},{type:n.FRAGMENT_SHADER,src:q.a}],uniforms:{screenSampler:{type:"1i",initial:1},screenTexBounds:{type:"4fv"},thickness:{type:"1f",initial:.5},depth:{type:"1f",initial:1},curve:{type:"1f",initial:4},transform:{type:"Matrix3fv",initial:k.a.create()}},attribs:["position","extra"]}),n.activeTexture(n.TEXTURE0),n.getParameter(n.MAX_TEXTURE_SIZE);var E=!0,g=!1,A=void 0;try{for(var S,_=t[Symbol.iterator]();!(E=(S=_.next()).done);E=!0){var B=S.value,I=n.createTexture();I.groupId=B.id,n.bindTexture(n.TEXTURE_2D,I),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,B.image),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,B.filtering?n.LINEAR:n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,B.filtering?n.LINEAR:n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);for(var O=Object(Y.a)(B.image.naturalWidth,B.image.naturalHeight),N=Object.entries(B.rects),L=0;L<N.length;L++){var G,H=o()(N[L],2),V=H[0],Q=H[1],Z=Q.pos,K=Q.size;this.textures[V]={texture:I,size:Y.a.apply(void 0,a()(K)),uva:Y.a.apply(void 0,a()(Z)).divV2(O),uvb:(G=Y.a.apply(void 0,a()(Z))).add.apply(G,a()(K)).divV2(O)}}}}catch(t){g=!0,A=t}finally{try{E||null==_.return||_.return()}finally{if(g)throw A}}this.triBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.triBuffer),this.triBufferSize=1048576,n.bufferData(n.ARRAY_BUFFER,this.triBufferSize,n.DYNAMIC_DRAW),this.lineBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.lineBuffer),this.lineBufferSize=1024,n.bufferData(n.ARRAY_BUFFER,this.lineBufferSize,n.DYNAMIC_DRAW),this.uiTriBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.uiTriBuffer),this.uiTriBufferSize=4096,n.bufferData(n.ARRAY_BUFFER,this.uiTriBufferSize,n.DYNAMIC_DRAW),this.screenQuadBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.screenQuadBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);var J=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.size,i=void 0===a?f:a,o=e.rb,u=void 0!==o&&o,s=e.filtering,c=void 0===s?n.NEAREST:s,l="".concat(t,"Tex"),h=r[t]=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,h);var d=r[l]=n.createTexture();return n.bindTexture(n.TEXTURE_2D,d),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,c),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,i.x,i.y,0,n.RGBA,n.UNSIGNED_BYTE,null),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,d,0),u&&(r[u]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r[u]),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,f.x,f.y),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,r[u]),n.bindRenderbuffer(n.RENDERBUFFER,null)),[h,d]};J("fb",{rb:"rb"}),J("postprocessA"),J("postprocessB"),J("offscreen",{size:Object(Y.a)(2048,2048)}),n.bindFramebuffer(n.FRAMEBUFFER,null),n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)}},{key:"newFrame",value:function(t){var r=t.camera,n=this.gl,e=this.view=k.b.create();k.b.translate(e,e,[-r.x,-r.y,0]);for(var a=Object.values(this.programs),i=0;i<a.length;i++){var o=a[i];o.uniforms.view&&(n.useProgram(o),this.setUniform(o.uniforms.view,e))}}},{key:"drawWorld_",value:function(){var t=this.gl;if(t.clearColor(0,0,0,0),this.tris){var r=0,n=new Float32Array(7*this.tris*3),e=[],i=a()(this.gameQuadGroups).sort(function(t,r){return o()(t,1)[0]-o()(r,1)[0]}),u=!0,s=!1,c=void 0;try{for(var f,l=i[Symbol.iterator]();!(u=(f=l.next()).done);u=!0){var h=o()(f.value,2),d=(h[0],h[1]),v=!0,p=!1,m=void 0;try{for(var x,b=d[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var y=o()(x.value,2),M=y[0],E=y[1],T={shader:M,spans:[]},g=!0,R=!1,A=void 0;try{for(var F,S=E[Symbol.iterator]();!(g=(F=S.next()).done);g=!0){var w=o()(F.value,2),_=w[0],D=w[1],B={texture:_,first:r/7,count:0};T.spans.push(B);var U=!0,I=!1,C=void 0;try{for(var O,P=D[Symbol.iterator]();!(U=(O=P.next()).done);U=!0){var N=O.value,z=N.vs,L=N.ex,X=N.size,G=N.z,q=N.alpha;if(M.program.uniforms.screenSampler){M.uniforms.screenTexBounds,B.offscreen=X;var H=B.offscreen.clone().divScalar(2048);n[r++]=-1,n[r++]=-1,n[r++]=0,n[r++]=L[0].uvx,n[r++]=L[0].uvy,n[r++]=L[0].sx,n[r++]=L[0].sy,n[r++]=-1,n[r++]=1,n[r++]=0,n[r++]=L[1].uvx,n[r++]=L[1].uvy,n[r++]=L[1].sx,n[r++]=L[1].sy,n[r++]=1,n[r++]=-1,n[r++]=0,n[r++]=L[3].uvx,n[r++]=L[3].uvy,n[r++]=L[3].sx,n[r++]=L[3].sy,n[r++]=-1,n[r++]=1,n[r++]=0,n[r++]=L[1].uvx,n[r++]=L[1].uvy,n[r++]=L[1].sx,n[r++]=L[1].sy,n[r++]=1,n[r++]=1,n[r++]=0,n[r++]=L[2].uvx,n[r++]=L[2].uvy,n[r++]=L[2].sx,n[r++]=L[2].sy,n[r++]=1,n[r++]=-1,n[r++]=0,n[r++]=L[3].uvx,n[r++]=L[3].uvy,n[r++]=L[3].sx,n[r++]=L[3].sy,n[r++]=z[0].x,n[r++]=z[0].y,n[r++]=G,n[r++]=0,n[r++]=0,n[r++]=L[0].l,n[r++]=q,n[r++]=z[1].x,n[r++]=z[1].y,n[r++]=G,n[r++]=0,n[r++]=H.y,n[r++]=L[1].l,n[r++]=q,n[r++]=z[3].x,n[r++]=z[3].y,n[r++]=G,n[r++]=H.x,n[r++]=0,n[r++]=L[3].l,n[r++]=q,n[r++]=z[1].x,n[r++]=z[1].y,n[r++]=G,n[r++]=0,n[r++]=H.y,n[r++]=L[1].l,n[r++]=q,n[r++]=z[2].x,n[r++]=z[2].y,n[r++]=G,n[r++]=H.x,n[r++]=H.y,n[r++]=L[2].l,n[r++]=q,n[r++]=z[3].x,n[r++]=z[3].y,n[r++]=G,n[r++]=H.x,n[r++]=0,n[r++]=L[3].l,n[r++]=q}else n[r++]=z[0].x,n[r++]=z[0].y,n[r++]=G,n[r++]=L[0].uvx,n[r++]=L[0].uvy,n[r++]=L[0].l,n[r++]=q,n[r++]=z[1].x,n[r++]=z[1].y,n[r++]=G,n[r++]=L[1].uvx,n[r++]=L[1].uvy,n[r++]=L[1].l,n[r++]=q,n[r++]=z[3].x,n[r++]=z[3].y,n[r++]=G,n[r++]=L[3].uvx,n[r++]=L[3].uvy,n[r++]=L[3].l,n[r++]=q,n[r++]=z[1].x,n[r++]=z[1].y,n[r++]=G,n[r++]=L[1].uvx,n[r++]=L[1].uvy,n[r++]=L[1].l,n[r++]=q,n[r++]=z[2].x,n[r++]=z[2].y,n[r++]=G,n[r++]=L[2].uvx,n[r++]=L[2].uvy,n[r++]=L[2].l,n[r++]=q,n[r++]=z[3].x,n[r++]=z[3].y,n[r++]=G,n[r++]=L[3].uvx,n[r++]=L[3].uvy,n[r++]=L[3].l,n[r++]=q;B.count+=6}}catch(t){I=!0,C=t}finally{try{U||null==P.return||P.return()}finally{if(I)throw C}}}}catch(t){R=!0,A=t}finally{try{g||null==S.return||S.return()}finally{if(R)throw A}}e.push(T)}}catch(t){p=!0,m=t}finally{try{v||null==b.return||b.return()}finally{if(p)throw m}}}}catch(t){s=!0,c=t}finally{try{u||null==l.return||l.return()}finally{if(s)throw c}}t.bindBuffer(t.ARRAY_BUFFER,this.triBuffer);var j=4*n.length;j>this.triBufferSize?(t.bufferData(t.ARRAY_BUFFER,n,t.DYNAMIC_DRAW),this.triBufferSize=j):t.bufferSubData(t.ARRAY_BUFFER,0,n),t.vertexAttribPointer(this.programs.world.attribs.position,3,t.FLOAT,!1,28,0),t.vertexAttribPointer(this.programs.world.attribs.extra,4,t.FLOAT,!1,28,12);for(var Y=0;Y<e.length;Y++){var V=e[Y],W=(M=V.shader,V.spans);t.useProgram(M.program);for(var k=Object.entries(M.uniforms),Q=0;Q<k.length;Q++){var Z=o()(k[Q],2),K=Z[0],J=Z[1];this.setUniform(M.program.uniforms[K],J)}var $=!0,tt=!1,rt=void 0;try{for(var nt,et=W[Symbol.iterator]();!($=(nt=et.next()).done);$=!0){var at=nt.value,it=(_=at.texture,at.first),ot=at.count,ut=at.offscreen;ut?(t.bindFramebuffer(t.FRAMEBUFFER,this.offscreen),_&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,_)),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.fbTex),t.viewport(0,0,ut.x,ut.y),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,it,ot),t.bindFramebuffer(t.FRAMEBUFFER,this.fb),t.useProgram(this.programs.world),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.offscreenTex),t.viewport(0,0,this.viewport.x,this.viewport.y),t.drawArrays(t.TRIANGLES,it+ot,ot),t.useProgram(M.program)):(t.bindTexture(t.TEXTURE_2D,_),t.drawArrays(t.TRIANGLES,it,ot))}}catch(t){tt=!0,rt=t}finally{try{$||null==et.return||et.return()}finally{if(tt)throw rt}}}}}},{key:"drawUI_",value:function(){var t=this.gl,r=new Float32Array(7*this.uiTris*3);if(this.uiTris){var n=0,e=!0,a=!1,i=void 0;try{for(var u,s=this.coloredQuads[Symbol.iterator]();!(e=(u=s.next()).done);e=!0){var c=u.value,f=c.a,l=c.b,h=c.color;r[n++]=f.x,r[n++]=f.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3],r[n++]=f.x,r[n++]=l.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3],r[n++]=l.x,r[n++]=f.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3],r[n++]=f.x,r[n++]=l.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3],r[n++]=l.x,r[n++]=l.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3],r[n++]=l.x,r[n++]=f.y,r[n++]=0,r[n++]=h[0],r[n++]=h[1],r[n++]=h[2],r[n++]=h[3]}}catch(t){a=!0,i=t}finally{try{e||null==s.return||s.return()}finally{if(a)throw i}}var d=[],v=!0,p=!1,m=void 0;try{for(var x,b=this.uiQuadGroups[Symbol.iterator]();!(v=(x=b.next()).done);v=!0){var y=o()(x.value,2),M=y[0],E=y[1],T={texture:M,first:n/7,count:0};d.push(T);var g=!0,R=!1,A=void 0;try{for(var F,S=E[Symbol.iterator]();!(g=(F=S.next()).done);g=!0){var w=F.value,_=(f=w.a,l=w.b,w.alpha),D=w.ex;r[n++]=f.x,r[n++]=f.y,r[n++]=0,r[n++]=D[0].x,r[n++]=D[0].y,r[n++]=D[0].l,r[n++]=_,r[n++]=f.x,r[n++]=l.y,r[n++]=0,r[n++]=D[1].x,r[n++]=D[1].y,r[n++]=D[1].l,r[n++]=_,r[n++]=l.x,r[n++]=f.y,r[n++]=0,r[n++]=D[3].x,r[n++]=D[3].y,r[n++]=D[3].l,r[n++]=_,r[n++]=f.x,r[n++]=l.y,r[n++]=0,r[n++]=D[1].x,r[n++]=D[1].y,r[n++]=D[1].l,r[n++]=_,r[n++]=l.x,r[n++]=l.y,r[n++]=0,r[n++]=D[2].x,r[n++]=D[2].y,r[n++]=D[2].l,r[n++]=_,r[n++]=l.x,r[n++]=f.y,r[n++]=0,r[n++]=D[3].x,r[n++]=D[3].y,r[n++]=D[3].l,r[n++]=_,T.count+=6}}catch(t){R=!0,A=t}finally{try{g||null==S.return||S.return()}finally{if(R)throw A}}}}catch(t){p=!0,m=t}finally{try{v||null==b.return||b.return()}finally{if(p)throw m}}t.bindBuffer(t.ARRAY_BUFFER,this.uiTriBuffer);var B=4*r.length;if(B>this.uiTriBufferSize?(t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW),this.uiTriBufferSize=B):t.bufferSubData(t.ARRAY_BUFFER,0,r),t.vertexAttribPointer(this.programs.color.attribs.position,3,t.FLOAT,!1,28,0),t.vertexAttribPointer(this.programs.color.attribs.extra,4,t.FLOAT,!1,28,12),this.coloredQuads.length&&(t.useProgram(this.programs.color),t.drawArrays(t.TRIANGLES,0,6*this.coloredQuads.length)),d.length){t.useProgram(this.programs.ui);for(var U=0;U<d.length;U++){var I=d[U],C=(M=I.texture,I.first),O=I.count;t.bindTexture(t.TEXTURE_2D,M),t.drawArrays(t.TRIANGLES,C,O)}}}if(this.lines){t.useProgram(this.programs.color),r=new Float32Array(7*this.lines*2);var P=0,N=!0,z=!1,L=void 0;try{for(var X,G=this.boxes[Symbol.iterator]();!(N=(X=G.next()).done);N=!0){var q=X.value;f=q.a,l=q.b,h=q.color,r[P++]=f.x,r[P++]=f.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=l.x,r[P++]=f.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=l.x,r[P++]=f.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=l.x,r[P++]=l.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=l.x,r[P++]=l.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=f.x,r[P++]=l.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=f.x,r[P++]=l.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3],r[P++]=f.x,r[P++]=f.y,r[P++]=0,r[P++]=h[0],r[P++]=h[1],r[P++]=h[2],r[P++]=h[3]}}catch(t){z=!0,L=t}finally{try{N||null==G.return||G.return()}finally{if(z)throw L}}t.bindBuffer(t.ARRAY_BUFFER,this.lineBuffer);var H=4*r.length;H>this.lineBufferSize?(t.bufferData(t.ARRAY_BUFFER,r,t.DYNAMIC_DRAW),this.lineBufferSize=H):t.bufferSubData(t.ARRAY_BUFFER,0,r),t.vertexAttribPointer(this.programs.color.attribs.position,3,t.FLOAT,!1,28,0),t.vertexAttribPointer(this.programs.color.attribs.extra,4,t.FLOAT,!1,28,12),t.drawArrays(t.LINES,0,2*this.lines)}}},{key:"endFrame",value:function(t){var r=this,n=t.separation,e=this.gl;e.canvas,e.clearColor(0,0,0,1),e.bindFramebuffer(e.FRAMEBUFFER,this.fb),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.drawWorld_(),this.drawUI_(),e.bindBuffer(e.ARRAY_BUFFER,this.screenQuadBuffer),e.vertexAttribPointer(this.programs.screen.attribs.position,2,e.FLOAT,!1,8,0),e.disableVertexAttribArray(this.programs.world.attribs.extra),e.clearColor(0,0,0,1),this.config.postProcessing?(e.useProgram(this.programs.highlights),e.bindTexture(e.TEXTURE_2D,this.fbTex),e.bindFramebuffer(e.FRAMEBUFFER,this.postprocessA),e.drawArrays(e.TRIANGLES,0,6),e.useProgram(this.programs.blur),e.bindFramebuffer(e.FRAMEBUFFER,this.postprocessB),e.bindTexture(e.TEXTURE_2D,this.postprocessATex),this.setUniform(this.programs.blur.uniforms.blurVector,new Float32Array([1,0])),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,this.postprocessA),e.bindTexture(e.TEXTURE_2D,this.postprocessBTex),this.setUniform(this.programs.blur.uniforms.blurVector,new Float32Array([0,1])),e.drawArrays(e.TRIANGLES,0,6),e.viewport(0,0,this.viewport.x,this.viewport.y)):(e.bindFramebuffer(e.FRAMEBUFFER,this.postprocessA),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(this.programs.screen),this.config.postProcessing?this.setUniform(this.programs.screen.uniforms.separation,n.map(function(t,n){return t/(n%2?r.fbSize.y:r.fbSize.x)})):this.setUniform(this.programs.screen.uniforms.separation,this.programs.screen.uniforms.separation.initial),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clear(e.COLOR_BUFFER_BIT),e.bindTexture(e.TEXTURE_2D,this.fbTex),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.postprocessATex),e.activeTexture(e.TEXTURE0),e.drawArrays(e.TRIANGLES,0,6),e.enableVertexAttribArray(this.programs.world.attribs.extra),this.alpha=1,this.z=0,this.tris=0,this.gameQuadGroups=new Map,this.uiQuadGroups=new Map,this.shaderArgs=new Map,this.coloredQuads=[],this.uiTris=2,this.boxes=[],this.lines=0}}]),t}()},23:function(t,r){t.exports="attribute vec3 position;\nattribute vec4 extra;\n\nuniform mat4 projection;\nuniform mat4 view;\nuniform vec2 fbScale;\nvarying vec4 texCoord;\nvarying vec2 fbPosition;\n\nvoid main(void) {\n  gl_Position = projection * view * vec4(floor(position + 0.5), 1.0);\n  fbPosition = (gl_Position.xy * 0.5 + 0.5) * fbScale;\n  texCoord = extra;\n}\n"},24:function(t,r){t.exports="attribute vec3 position;\nattribute vec4 extra;\n\nvarying vec4 texCoord;\n\nvoid main(void) {\n  gl_Position = vec4(position, 1.0);\n  texCoord = extra;\n}\n"},25:function(t,r,n){var e=n(79);t.exports=function(t,r){if(null==t)return{};var n,a,i=e(t,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}},4:function(t,r,n){"use strict";var e={};n.r(e),n.d(e,"create",function(){return f}),n.d(e,"fromMat4",function(){return l}),n.d(e,"clone",function(){return h}),n.d(e,"copy",function(){return d}),n.d(e,"fromValues",function(){return v}),n.d(e,"set",function(){return p}),n.d(e,"identity",function(){return m}),n.d(e,"transpose",function(){return x}),n.d(e,"invert",function(){return b}),n.d(e,"adjoint",function(){return y}),n.d(e,"determinant",function(){return M}),n.d(e,"multiply",function(){return E}),n.d(e,"translate",function(){return T}),n.d(e,"rotate",function(){return g}),n.d(e,"scale",function(){return R}),n.d(e,"fromTranslation",function(){return A}),n.d(e,"fromRotation",function(){return F}),n.d(e,"fromScaling",function(){return S}),n.d(e,"fromMat2d",function(){return w}),n.d(e,"fromQuat",function(){return _}),n.d(e,"normalFromMat4",function(){return D}),n.d(e,"projection",function(){return B}),n.d(e,"str",function(){return U}),n.d(e,"frob",function(){return I}),n.d(e,"add",function(){return C}),n.d(e,"subtract",function(){return O}),n.d(e,"multiplyScalar",function(){return P}),n.d(e,"multiplyScalarAndAdd",function(){return N}),n.d(e,"exactEquals",function(){return z}),n.d(e,"equals",function(){return L}),n.d(e,"mul",function(){return X}),n.d(e,"sub",function(){return G});var a={};n.r(a),n.d(a,"create",function(){return q}),n.d(a,"clone",function(){return H}),n.d(a,"copy",function(){return j}),n.d(a,"fromValues",function(){return Y}),n.d(a,"set",function(){return V}),n.d(a,"identity",function(){return W}),n.d(a,"transpose",function(){return k}),n.d(a,"invert",function(){return Q}),n.d(a,"adjoint",function(){return Z}),n.d(a,"determinant",function(){return K}),n.d(a,"multiply",function(){return J}),n.d(a,"translate",function(){return $}),n.d(a,"scale",function(){return tt}),n.d(a,"rotate",function(){return rt}),n.d(a,"rotateX",function(){return nt}),n.d(a,"rotateY",function(){return et}),n.d(a,"rotateZ",function(){return at}),n.d(a,"fromTranslation",function(){return it}),n.d(a,"fromScaling",function(){return ot}),n.d(a,"fromRotation",function(){return ut}),n.d(a,"fromXRotation",function(){return st}),n.d(a,"fromYRotation",function(){return ct}),n.d(a,"fromZRotation",function(){return ft}),n.d(a,"fromRotationTranslation",function(){return lt}),n.d(a,"fromQuat2",function(){return ht}),n.d(a,"getTranslation",function(){return dt}),n.d(a,"getScaling",function(){return vt}),n.d(a,"getRotation",function(){return pt}),n.d(a,"fromRotationTranslationScale",function(){return mt}),n.d(a,"fromRotationTranslationScaleOrigin",function(){return xt}),n.d(a,"fromQuat",function(){return bt}),n.d(a,"frustum",function(){return yt}),n.d(a,"perspective",function(){return Mt}),n.d(a,"perspectiveFromFieldOfView",function(){return Et}),n.d(a,"ortho",function(){return Tt}),n.d(a,"lookAt",function(){return gt}),n.d(a,"targetTo",function(){return Rt}),n.d(a,"str",function(){return At}),n.d(a,"frob",function(){return Ft}),n.d(a,"add",function(){return St}),n.d(a,"subtract",function(){return wt}),n.d(a,"multiplyScalar",function(){return _t}),n.d(a,"multiplyScalarAndAdd",function(){return Dt}),n.d(a,"exactEquals",function(){return Bt}),n.d(a,"equals",function(){return Ut}),n.d(a,"mul",function(){return It}),n.d(a,"sub",function(){return Ct});var i={};n.r(i),n.d(i,"create",function(){return Ot}),n.d(i,"clone",function(){return Pt}),n.d(i,"fromValues",function(){return Nt}),n.d(i,"copy",function(){return zt}),n.d(i,"set",function(){return Lt}),n.d(i,"add",function(){return Xt}),n.d(i,"subtract",function(){return Gt}),n.d(i,"multiply",function(){return qt}),n.d(i,"divide",function(){return Ht}),n.d(i,"ceil",function(){return jt}),n.d(i,"floor",function(){return Yt}),n.d(i,"min",function(){return Vt}),n.d(i,"max",function(){return Wt}),n.d(i,"round",function(){return kt}),n.d(i,"scale",function(){return Qt}),n.d(i,"scaleAndAdd",function(){return Zt}),n.d(i,"distance",function(){return Kt}),n.d(i,"squaredDistance",function(){return Jt}),n.d(i,"length",function(){return $t}),n.d(i,"squaredLength",function(){return tr}),n.d(i,"negate",function(){return rr}),n.d(i,"inverse",function(){return nr}),n.d(i,"normalize",function(){return er}),n.d(i,"dot",function(){return ar}),n.d(i,"cross",function(){return ir}),n.d(i,"lerp",function(){return or}),n.d(i,"random",function(){return ur}),n.d(i,"transformMat2",function(){return sr}),n.d(i,"transformMat2d",function(){return cr}),n.d(i,"transformMat3",function(){return fr}),n.d(i,"transformMat4",function(){return lr}),n.d(i,"rotate",function(){return hr}),n.d(i,"angle",function(){return dr}),n.d(i,"str",function(){return vr}),n.d(i,"exactEquals",function(){return pr}),n.d(i,"equals",function(){return mr}),n.d(i,"len",function(){return br}),n.d(i,"sub",function(){return yr}),n.d(i,"mul",function(){return Mr}),n.d(i,"div",function(){return Er}),n.d(i,"dist",function(){return Tr}),n.d(i,"sqrDist",function(){return gr}),n.d(i,"sqrLen",function(){return Rr}),n.d(i,"forEach",function(){return Ar});var o={};n.r(o),n.d(o,"create",function(){return Fr}),n.d(o,"clone",function(){return Sr}),n.d(o,"length",function(){return wr}),n.d(o,"fromValues",function(){return _r}),n.d(o,"copy",function(){return Dr}),n.d(o,"set",function(){return Br}),n.d(o,"add",function(){return Ur}),n.d(o,"subtract",function(){return Ir}),n.d(o,"multiply",function(){return Cr}),n.d(o,"divide",function(){return Or}),n.d(o,"ceil",function(){return Pr}),n.d(o,"floor",function(){return Nr}),n.d(o,"min",function(){return zr}),n.d(o,"max",function(){return Lr}),n.d(o,"round",function(){return Xr}),n.d(o,"scale",function(){return Gr}),n.d(o,"scaleAndAdd",function(){return qr}),n.d(o,"distance",function(){return Hr}),n.d(o,"squaredDistance",function(){return jr}),n.d(o,"squaredLength",function(){return Yr}),n.d(o,"negate",function(){return Vr}),n.d(o,"inverse",function(){return Wr}),n.d(o,"normalize",function(){return kr}),n.d(o,"dot",function(){return Qr}),n.d(o,"cross",function(){return Zr}),n.d(o,"lerp",function(){return Kr}),n.d(o,"hermite",function(){return Jr}),n.d(o,"bezier",function(){return $r}),n.d(o,"random",function(){return tn}),n.d(o,"transformMat4",function(){return rn}),n.d(o,"transformMat3",function(){return nn}),n.d(o,"transformQuat",function(){return en}),n.d(o,"rotateX",function(){return an}),n.d(o,"rotateY",function(){return on}),n.d(o,"rotateZ",function(){return un}),n.d(o,"angle",function(){return sn}),n.d(o,"str",function(){return cn}),n.d(o,"exactEquals",function(){return fn}),n.d(o,"equals",function(){return ln}),n.d(o,"sub",function(){return hn}),n.d(o,"mul",function(){return dn}),n.d(o,"div",function(){return vn}),n.d(o,"dist",function(){return pn}),n.d(o,"sqrDist",function(){return mn}),n.d(o,"len",function(){return xn}),n.d(o,"sqrLen",function(){return bn}),n.d(o,"forEach",function(){return yn});var u=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array,c=Math.random;function f(){var t=new s(9);return s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function l(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function h(t){var r=new s(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r}function d(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function v(t,r,n,e,a,i,o,u,c){var f=new s(9);return f[0]=t,f[1]=r,f[2]=n,f[3]=e,f[4]=a,f[5]=i,f[6]=o,f[7]=u,f[8]=c,f}function p(t,r,n,e,a,i,o,u,s,c){return t[0]=r,t[1]=n,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=c,t}function m(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function x(t,r){if(t===r){var n=r[1],e=r[2],a=r[5];t[1]=r[3],t[2]=r[6],t[3]=n,t[5]=r[7],t[6]=e,t[7]=a}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function b(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],f=r[8],l=f*o-u*c,h=-f*i+u*s,d=c*i-o*s,v=n*l+e*h+a*d;return v?(v=1/v,t[0]=l*v,t[1]=(-f*e+a*c)*v,t[2]=(u*e-a*o)*v,t[3]=h*v,t[4]=(f*n-a*s)*v,t[5]=(-u*n+a*i)*v,t[6]=d*v,t[7]=(-c*n+e*s)*v,t[8]=(o*n-e*i)*v,t):null}function y(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],f=r[8];return t[0]=o*f-u*c,t[1]=a*c-e*f,t[2]=e*u-a*o,t[3]=u*s-i*f,t[4]=n*f-a*s,t[5]=a*i-n*u,t[6]=i*c-o*s,t[7]=e*s-n*c,t[8]=n*o-e*i,t}function M(t){var r=t[0],n=t[1],e=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],c=t[8];return r*(c*i-o*s)+n*(-c*a+o*u)+e*(s*a-i*u)}function E(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],f=r[7],l=r[8],h=n[0],d=n[1],v=n[2],p=n[3],m=n[4],x=n[5],b=n[6],y=n[7],M=n[8];return t[0]=h*e+d*o+v*c,t[1]=h*a+d*u+v*f,t[2]=h*i+d*s+v*l,t[3]=p*e+m*o+x*c,t[4]=p*a+m*u+x*f,t[5]=p*i+m*s+x*l,t[6]=b*e+y*o+M*c,t[7]=b*a+y*u+M*f,t[8]=b*i+y*s+M*l,t}function T(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],f=r[7],l=r[8],h=n[0],d=n[1];return t[0]=e,t[1]=a,t[2]=i,t[3]=o,t[4]=u,t[5]=s,t[6]=h*e+d*o+c,t[7]=h*a+d*u+f,t[8]=h*i+d*s+l,t}function g(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],f=r[7],l=r[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*e+h*o,t[1]=d*a+h*u,t[2]=d*i+h*s,t[3]=d*o-h*e,t[4]=d*u-h*a,t[5]=d*s-h*i,t[6]=c,t[7]=f,t[8]=l,t}function R(t,r,n){var e=n[0],a=n[1];return t[0]=e*r[0],t[1]=e*r[1],t[2]=e*r[2],t[3]=a*r[3],t[4]=a*r[4],t[5]=a*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function A(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t}function F(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=n,t[2]=0,t[3]=-n,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function w(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t}function _(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=n+n,u=e+e,s=a+a,c=n*o,f=e*o,l=e*u,h=a*o,d=a*u,v=a*s,p=i*o,m=i*u,x=i*s;return t[0]=1-l-v,t[3]=f-x,t[6]=h+m,t[1]=f+x,t[4]=1-c-v,t[7]=d-p,t[2]=h-m,t[5]=d+p,t[8]=1-c-l,t}function D(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],f=r[8],l=r[9],h=r[10],d=r[11],v=r[12],p=r[13],m=r[14],x=r[15],b=n*u-e*o,y=n*s-a*o,M=n*c-i*o,E=e*s-a*u,T=e*c-i*u,g=a*c-i*s,R=f*p-l*v,A=f*m-h*v,F=f*x-d*v,S=l*m-h*p,w=l*x-d*p,_=h*x-d*m,D=b*_-y*w+M*S+E*F-T*A+g*R;return D?(D=1/D,t[0]=(u*_-s*w+c*S)*D,t[1]=(s*F-o*_-c*A)*D,t[2]=(o*w-u*F+c*R)*D,t[3]=(a*w-e*_-i*S)*D,t[4]=(n*_-a*F+i*A)*D,t[5]=(e*F-n*w-i*R)*D,t[6]=(p*g-m*T+x*E)*D,t[7]=(m*M-v*g-x*y)*D,t[8]=(v*T-p*M+x*b)*D,t):null}function B(t,r,n){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function U(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function I(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function C(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t}function O(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t}function P(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t}function N(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t[2]=r[2]+n[2]*e,t[3]=r[3]+n[3]*e,t[4]=r[4]+n[4]*e,t[5]=r[5]+n[5]*e,t[6]=r[6]+n[6]*e,t[7]=r[7]+n[7]*e,t[8]=r[8]+n[8]*e,t}function z(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]}function L(t,r){var n=t[0],e=t[1],a=t[2],i=t[3],o=t[4],s=t[5],c=t[6],f=t[7],l=t[8],h=r[0],d=r[1],v=r[2],p=r[3],m=r[4],x=r[5],b=r[6],y=r[7],M=r[8];return Math.abs(n-h)<=u*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(e-d)<=u*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(a-v)<=u*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(i-p)<=u*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-m)<=u*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-x)<=u*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(c-b)<=u*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-y)<=u*Math.max(1,Math.abs(f),Math.abs(y))&&Math.abs(l-M)<=u*Math.max(1,Math.abs(l),Math.abs(M))}Math.PI;var X=E,G=O;function q(){var t=new s(16);return s!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function H(t){var r=new s(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function j(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function Y(t,r,n,e,a,i,o,u,c,f,l,h,d,v,p,m){var x=new s(16);return x[0]=t,x[1]=r,x[2]=n,x[3]=e,x[4]=a,x[5]=i,x[6]=o,x[7]=u,x[8]=c,x[9]=f,x[10]=l,x[11]=h,x[12]=d,x[13]=v,x[14]=p,x[15]=m,x}function V(t,r,n,e,a,i,o,u,s,c,f,l,h,d,v,p,m){return t[0]=r,t[1]=n,t[2]=e,t[3]=a,t[4]=i,t[5]=o,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=v,t[14]=p,t[15]=m,t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function k(t,r){if(t===r){var n=r[1],e=r[2],a=r[3],i=r[6],o=r[7],u=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=n,t[6]=r[9],t[7]=r[13],t[8]=e,t[9]=i,t[11]=r[14],t[12]=a,t[13]=o,t[14]=u}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function Q(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],f=r[8],l=r[9],h=r[10],d=r[11],v=r[12],p=r[13],m=r[14],x=r[15],b=n*u-e*o,y=n*s-a*o,M=n*c-i*o,E=e*s-a*u,T=e*c-i*u,g=a*c-i*s,R=f*p-l*v,A=f*m-h*v,F=f*x-d*v,S=l*m-h*p,w=l*x-d*p,_=h*x-d*m,D=b*_-y*w+M*S+E*F-T*A+g*R;return D?(D=1/D,t[0]=(u*_-s*w+c*S)*D,t[1]=(a*w-e*_-i*S)*D,t[2]=(p*g-m*T+x*E)*D,t[3]=(h*T-l*g-d*E)*D,t[4]=(s*F-o*_-c*A)*D,t[5]=(n*_-a*F+i*A)*D,t[6]=(m*M-v*g-x*y)*D,t[7]=(f*g-h*M+d*y)*D,t[8]=(o*w-u*F+c*R)*D,t[9]=(e*F-n*w-i*R)*D,t[10]=(v*T-p*M+x*b)*D,t[11]=(l*M-f*T-d*b)*D,t[12]=(u*A-o*S-s*R)*D,t[13]=(n*S-e*A+a*R)*D,t[14]=(p*y-v*E-m*b)*D,t[15]=(f*E-l*y+h*b)*D,t):null}function Z(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=r[4],u=r[5],s=r[6],c=r[7],f=r[8],l=r[9],h=r[10],d=r[11],v=r[12],p=r[13],m=r[14],x=r[15];return t[0]=u*(h*x-d*m)-l*(s*x-c*m)+p*(s*d-c*h),t[1]=-(e*(h*x-d*m)-l*(a*x-i*m)+p*(a*d-i*h)),t[2]=e*(s*x-c*m)-u*(a*x-i*m)+p*(a*c-i*s),t[3]=-(e*(s*d-c*h)-u*(a*d-i*h)+l*(a*c-i*s)),t[4]=-(o*(h*x-d*m)-f*(s*x-c*m)+v*(s*d-c*h)),t[5]=n*(h*x-d*m)-f*(a*x-i*m)+v*(a*d-i*h),t[6]=-(n*(s*x-c*m)-o*(a*x-i*m)+v*(a*c-i*s)),t[7]=n*(s*d-c*h)-o*(a*d-i*h)+f*(a*c-i*s),t[8]=o*(l*x-d*p)-f*(u*x-c*p)+v*(u*d-c*l),t[9]=-(n*(l*x-d*p)-f*(e*x-i*p)+v*(e*d-i*l)),t[10]=n*(u*x-c*p)-o*(e*x-i*p)+v*(e*c-i*u),t[11]=-(n*(u*d-c*l)-o*(e*d-i*l)+f*(e*c-i*u)),t[12]=-(o*(l*m-h*p)-f*(u*m-s*p)+v*(u*h-s*l)),t[13]=n*(l*m-h*p)-f*(e*m-a*p)+v*(e*h-a*l),t[14]=-(n*(u*m-s*p)-o*(e*m-a*p)+v*(e*s-a*u)),t[15]=n*(u*h-s*l)-o*(e*h-a*l)+f*(e*s-a*u),t}function K(t){var r=t[0],n=t[1],e=t[2],a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],v=t[13],p=t[14],m=t[15];return(r*o-n*i)*(l*m-h*p)-(r*u-e*i)*(f*m-h*v)+(r*s-a*i)*(f*p-l*v)+(n*u-e*o)*(c*m-h*d)-(n*s-a*o)*(c*p-l*d)+(e*s-a*u)*(c*v-f*d)}function J(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],u=r[4],s=r[5],c=r[6],f=r[7],l=r[8],h=r[9],d=r[10],v=r[11],p=r[12],m=r[13],x=r[14],b=r[15],y=n[0],M=n[1],E=n[2],T=n[3];return t[0]=y*e+M*u+E*l+T*p,t[1]=y*a+M*s+E*h+T*m,t[2]=y*i+M*c+E*d+T*x,t[3]=y*o+M*f+E*v+T*b,y=n[4],M=n[5],E=n[6],T=n[7],t[4]=y*e+M*u+E*l+T*p,t[5]=y*a+M*s+E*h+T*m,t[6]=y*i+M*c+E*d+T*x,t[7]=y*o+M*f+E*v+T*b,y=n[8],M=n[9],E=n[10],T=n[11],t[8]=y*e+M*u+E*l+T*p,t[9]=y*a+M*s+E*h+T*m,t[10]=y*i+M*c+E*d+T*x,t[11]=y*o+M*f+E*v+T*b,y=n[12],M=n[13],E=n[14],T=n[15],t[12]=y*e+M*u+E*l+T*p,t[13]=y*a+M*s+E*h+T*m,t[14]=y*i+M*c+E*d+T*x,t[15]=y*o+M*f+E*v+T*b,t}function $(t,r,n){var e=n[0],a=n[1],i=n[2],o=void 0,u=void 0,s=void 0,c=void 0,f=void 0,l=void 0,h=void 0,d=void 0,v=void 0,p=void 0,m=void 0,x=void 0;return r===t?(t[12]=r[0]*e+r[4]*a+r[8]*i+r[12],t[13]=r[1]*e+r[5]*a+r[9]*i+r[13],t[14]=r[2]*e+r[6]*a+r[10]*i+r[14],t[15]=r[3]*e+r[7]*a+r[11]*i+r[15]):(o=r[0],u=r[1],s=r[2],c=r[3],f=r[4],l=r[5],h=r[6],d=r[7],v=r[8],p=r[9],m=r[10],x=r[11],t[0]=o,t[1]=u,t[2]=s,t[3]=c,t[4]=f,t[5]=l,t[6]=h,t[7]=d,t[8]=v,t[9]=p,t[10]=m,t[11]=x,t[12]=o*e+f*a+v*i+r[12],t[13]=u*e+l*a+p*i+r[13],t[14]=s*e+h*a+m*i+r[14],t[15]=c*e+d*a+x*i+r[15]),t}function tt(t,r,n){var e=n[0],a=n[1],i=n[2];return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=r[11]*i,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function rt(t,r,n,e){var a,i,o,s,c,f,l,h,d,v,p,m,x,b,y,M,E,T,g,R,A,F,S,w,_=e[0],D=e[1],B=e[2],U=Math.sqrt(_*_+D*D+B*B);return U<u?null:(_*=U=1/U,D*=U,B*=U,a=Math.sin(n),o=1-(i=Math.cos(n)),s=r[0],c=r[1],f=r[2],l=r[3],h=r[4],d=r[5],v=r[6],p=r[7],m=r[8],x=r[9],b=r[10],y=r[11],M=_*_*o+i,E=D*_*o+B*a,T=B*_*o-D*a,g=_*D*o-B*a,R=D*D*o+i,A=B*D*o+_*a,F=_*B*o+D*a,S=D*B*o-_*a,w=B*B*o+i,t[0]=s*M+h*E+m*T,t[1]=c*M+d*E+x*T,t[2]=f*M+v*E+b*T,t[3]=l*M+p*E+y*T,t[4]=s*g+h*R+m*A,t[5]=c*g+d*R+x*A,t[6]=f*g+v*R+b*A,t[7]=l*g+p*R+y*A,t[8]=s*F+h*S+m*w,t[9]=c*F+d*S+x*w,t[10]=f*F+v*S+b*w,t[11]=l*F+p*S+y*w,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function nt(t,r,n){var e=Math.sin(n),a=Math.cos(n),i=r[4],o=r[5],u=r[6],s=r[7],c=r[8],f=r[9],l=r[10],h=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=i*a+c*e,t[5]=o*a+f*e,t[6]=u*a+l*e,t[7]=s*a+h*e,t[8]=c*a-i*e,t[9]=f*a-o*e,t[10]=l*a-u*e,t[11]=h*a-s*e,t}function et(t,r,n){var e=Math.sin(n),a=Math.cos(n),i=r[0],o=r[1],u=r[2],s=r[3],c=r[8],f=r[9],l=r[10],h=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a-c*e,t[1]=o*a-f*e,t[2]=u*a-l*e,t[3]=s*a-h*e,t[8]=i*e+c*a,t[9]=o*e+f*a,t[10]=u*e+l*a,t[11]=s*e+h*a,t}function at(t,r,n){var e=Math.sin(n),a=Math.cos(n),i=r[0],o=r[1],u=r[2],s=r[3],c=r[4],f=r[5],l=r[6],h=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*a+c*e,t[1]=o*a+f*e,t[2]=u*a+l*e,t[3]=s*a+h*e,t[4]=c*a-i*e,t[5]=f*a-o*e,t[6]=l*a-u*e,t[7]=h*a-s*e,t}function it(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function ot(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ut(t,r,n){var e,a,i,o=n[0],s=n[1],c=n[2],f=Math.sqrt(o*o+s*s+c*c);return f<u?null:(o*=f=1/f,s*=f,c*=f,e=Math.sin(r),i=1-(a=Math.cos(r)),t[0]=o*o*i+a,t[1]=s*o*i+c*e,t[2]=c*o*i-s*e,t[3]=0,t[4]=o*s*i-c*e,t[5]=s*s*i+a,t[6]=c*s*i+o*e,t[7]=0,t[8]=o*c*i+s*e,t[9]=s*c*i-o*e,t[10]=c*c*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function st(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ft(t,r){var n=Math.sin(r),e=Math.cos(r);return t[0]=e,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function lt(t,r,n){var e=r[0],a=r[1],i=r[2],o=r[3],u=e+e,s=a+a,c=i+i,f=e*u,l=e*s,h=e*c,d=a*s,v=a*c,p=i*c,m=o*u,x=o*s,b=o*c;return t[0]=1-(d+p),t[1]=l+b,t[2]=h-x,t[3]=0,t[4]=l-b,t[5]=1-(f+p),t[6]=v+m,t[7]=0,t[8]=h+x,t[9]=v-m,t[10]=1-(f+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ht(t,r){var n=new s(3),e=-r[0],a=-r[1],i=-r[2],o=r[3],u=r[4],c=r[5],f=r[6],l=r[7],h=e*e+a*a+i*i+o*o;return h>0?(n[0]=2*(u*o+l*e+c*i-f*a)/h,n[1]=2*(c*o+l*a+f*e-u*i)/h,n[2]=2*(f*o+l*i+u*a-c*e)/h):(n[0]=2*(u*o+l*e+c*i-f*a),n[1]=2*(c*o+l*a+f*e-u*i),n[2]=2*(f*o+l*i+u*a-c*e)),lt(t,r,n),t}function dt(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function vt(t,r){var n=r[0],e=r[1],a=r[2],i=r[4],o=r[5],u=r[6],s=r[8],c=r[9],f=r[10];return t[0]=Math.sqrt(n*n+e*e+a*a),t[1]=Math.sqrt(i*i+o*o+u*u),t[2]=Math.sqrt(s*s+c*c+f*f),t}function pt(t,r){var n=r[0]+r[5]+r[10],e=0;return n>0?(e=2*Math.sqrt(n+1),t[3]=.25*e,t[0]=(r[6]-r[9])/e,t[1]=(r[8]-r[2])/e,t[2]=(r[1]-r[4])/e):r[0]>r[5]&&r[0]>r[10]?(e=2*Math.sqrt(1+r[0]-r[5]-r[10]),t[3]=(r[6]-r[9])/e,t[0]=.25*e,t[1]=(r[1]+r[4])/e,t[2]=(r[8]+r[2])/e):r[5]>r[10]?(e=2*Math.sqrt(1+r[5]-r[0]-r[10]),t[3]=(r[8]-r[2])/e,t[0]=(r[1]+r[4])/e,t[1]=.25*e,t[2]=(r[6]+r[9])/e):(e=2*Math.sqrt(1+r[10]-r[0]-r[5]),t[3]=(r[1]-r[4])/e,t[0]=(r[8]+r[2])/e,t[1]=(r[6]+r[9])/e,t[2]=.25*e),t}function mt(t,r,n,e){var a=r[0],i=r[1],o=r[2],u=r[3],s=a+a,c=i+i,f=o+o,l=a*s,h=a*c,d=a*f,v=i*c,p=i*f,m=o*f,x=u*s,b=u*c,y=u*f,M=e[0],E=e[1],T=e[2];return t[0]=(1-(v+m))*M,t[1]=(h+y)*M,t[2]=(d-b)*M,t[3]=0,t[4]=(h-y)*E,t[5]=(1-(l+m))*E,t[6]=(p+x)*E,t[7]=0,t[8]=(d+b)*T,t[9]=(p-x)*T,t[10]=(1-(l+v))*T,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function xt(t,r,n,e,a){var i=r[0],o=r[1],u=r[2],s=r[3],c=i+i,f=o+o,l=u+u,h=i*c,d=i*f,v=i*l,p=o*f,m=o*l,x=u*l,b=s*c,y=s*f,M=s*l,E=e[0],T=e[1],g=e[2],R=a[0],A=a[1],F=a[2],S=(1-(p+x))*E,w=(d+M)*E,_=(v-y)*E,D=(d-M)*T,B=(1-(h+x))*T,U=(m+b)*T,I=(v+y)*g,C=(m-b)*g,O=(1-(h+p))*g;return t[0]=S,t[1]=w,t[2]=_,t[3]=0,t[4]=D,t[5]=B,t[6]=U,t[7]=0,t[8]=I,t[9]=C,t[10]=O,t[11]=0,t[12]=n[0]+R-(S*R+D*A+I*F),t[13]=n[1]+A-(w*R+B*A+C*F),t[14]=n[2]+F-(_*R+U*A+O*F),t[15]=1,t}function bt(t,r){var n=r[0],e=r[1],a=r[2],i=r[3],o=n+n,u=e+e,s=a+a,c=n*o,f=e*o,l=e*u,h=a*o,d=a*u,v=a*s,p=i*o,m=i*u,x=i*s;return t[0]=1-l-v,t[1]=f+x,t[2]=h-m,t[3]=0,t[4]=f-x,t[5]=1-c-v,t[6]=d+p,t[7]=0,t[8]=h+m,t[9]=d-p,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function yt(t,r,n,e,a,i,o){var u=1/(n-r),s=1/(a-e),c=1/(i-o);return t[0]=2*i*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*s,t[6]=0,t[7]=0,t[8]=(n+r)*u,t[9]=(a+e)*s,t[10]=(o+i)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*i*2*c,t[15]=0,t}function Mt(t,r,n,e,a){var i=1/Math.tan(r/2),o=void 0;return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=a&&a!==1/0?(o=1/(e-a),t[10]=(a+e)*o,t[14]=2*a*e*o):(t[10]=-1,t[14]=-2*e),t}function Et(t,r,n,e){var a=Math.tan(r.upDegrees*Math.PI/180),i=Math.tan(r.downDegrees*Math.PI/180),o=Math.tan(r.leftDegrees*Math.PI/180),u=Math.tan(r.rightDegrees*Math.PI/180),s=2/(o+u),c=2/(a+i);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-u)*s*.5,t[9]=(a-i)*c*.5,t[10]=e/(n-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*n/(n-e),t[15]=0,t}function Tt(t,r,n,e,a,i,o){var u=1/(r-n),s=1/(e-a),c=1/(i-o);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+n)*u,t[13]=(a+e)*s,t[14]=(o+i)*c,t[15]=1,t}function gt(t,r,n,e){var a=void 0,i=void 0,o=void 0,s=void 0,c=void 0,f=void 0,l=void 0,h=void 0,d=void 0,v=void 0,p=r[0],m=r[1],x=r[2],b=e[0],y=e[1],M=e[2],E=n[0],T=n[1],g=n[2];return Math.abs(p-E)<u&&Math.abs(m-T)<u&&Math.abs(x-g)<u?W(t):(l=p-E,h=m-T,d=x-g,a=y*(d*=v=1/Math.sqrt(l*l+h*h+d*d))-M*(h*=v),i=M*(l*=v)-b*d,o=b*h-y*l,(v=Math.sqrt(a*a+i*i+o*o))?(a*=v=1/v,i*=v,o*=v):(a=0,i=0,o=0),s=h*o-d*i,c=d*a-l*o,f=l*i-h*a,(v=Math.sqrt(s*s+c*c+f*f))?(s*=v=1/v,c*=v,f*=v):(s=0,c=0,f=0),t[0]=a,t[1]=s,t[2]=l,t[3]=0,t[4]=i,t[5]=c,t[6]=h,t[7]=0,t[8]=o,t[9]=f,t[10]=d,t[11]=0,t[12]=-(a*p+i*m+o*x),t[13]=-(s*p+c*m+f*x),t[14]=-(l*p+h*m+d*x),t[15]=1,t)}function Rt(t,r,n,e){var a=r[0],i=r[1],o=r[2],u=e[0],s=e[1],c=e[2],f=a-n[0],l=i-n[1],h=o-n[2],d=f*f+l*l+h*h;d>0&&(f*=d=1/Math.sqrt(d),l*=d,h*=d);var v=s*h-c*l,p=c*f-u*h,m=u*l-s*f;return(d=v*v+p*p+m*m)>0&&(v*=d=1/Math.sqrt(d),p*=d,m*=d),t[0]=v,t[1]=p,t[2]=m,t[3]=0,t[4]=l*m-h*p,t[5]=h*v-f*m,t[6]=f*p-l*v,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=a,t[13]=i,t[14]=o,t[15]=1,t}function At(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ft(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function St(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t[9]=r[9]+n[9],t[10]=r[10]+n[10],t[11]=r[11]+n[11],t[12]=r[12]+n[12],t[13]=r[13]+n[13],t[14]=r[14]+n[14],t[15]=r[15]+n[15],t}function wt(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t[9]=r[9]-n[9],t[10]=r[10]-n[10],t[11]=r[11]-n[11],t[12]=r[12]-n[12],t[13]=r[13]-n[13],t[14]=r[14]-n[14],t[15]=r[15]-n[15],t}function _t(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t[9]=r[9]*n,t[10]=r[10]*n,t[11]=r[11]*n,t[12]=r[12]*n,t[13]=r[13]*n,t[14]=r[14]*n,t[15]=r[15]*n,t}function Dt(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t[2]=r[2]+n[2]*e,t[3]=r[3]+n[3]*e,t[4]=r[4]+n[4]*e,t[5]=r[5]+n[5]*e,t[6]=r[6]+n[6]*e,t[7]=r[7]+n[7]*e,t[8]=r[8]+n[8]*e,t[9]=r[9]+n[9]*e,t[10]=r[10]+n[10]*e,t[11]=r[11]+n[11]*e,t[12]=r[12]+n[12]*e,t[13]=r[13]+n[13]*e,t[14]=r[14]+n[14]*e,t[15]=r[15]+n[15]*e,t}function Bt(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]}function Ut(t,r){var n=t[0],e=t[1],a=t[2],i=t[3],o=t[4],s=t[5],c=t[6],f=t[7],l=t[8],h=t[9],d=t[10],v=t[11],p=t[12],m=t[13],x=t[14],b=t[15],y=r[0],M=r[1],E=r[2],T=r[3],g=r[4],R=r[5],A=r[6],F=r[7],S=r[8],w=r[9],_=r[10],D=r[11],B=r[12],U=r[13],I=r[14],C=r[15];return Math.abs(n-y)<=u*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(e-M)<=u*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(a-E)<=u*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(i-T)<=u*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(o-g)<=u*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(s-R)<=u*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-A)<=u*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-F)<=u*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(l-S)<=u*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-w)<=u*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(d-_)<=u*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(v-D)<=u*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(p-B)<=u*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(m-U)<=u*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(x-I)<=u*Math.max(1,Math.abs(x),Math.abs(I))&&Math.abs(b-C)<=u*Math.max(1,Math.abs(b),Math.abs(C))}var It=J,Ct=wt;function Ot(){var t=new s(2);return s!=Float32Array&&(t[0]=0,t[1]=0),t}function Pt(t){var r=new s(2);return r[0]=t[0],r[1]=t[1],r}function Nt(t,r){var n=new s(2);return n[0]=t,n[1]=r,n}function zt(t,r){return t[0]=r[0],t[1]=r[1],t}function Lt(t,r,n){return t[0]=r,t[1]=n,t}function Xt(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t}function Gt(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t}function qt(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t}function Ht(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t}function jt(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t}function Yt(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t}function Vt(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t}function Wt(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t}function kt(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t}function Qt(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t}function Zt(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t}function Kt(t,r){var n=r[0]-t[0],e=r[1]-t[1];return Math.sqrt(n*n+e*e)}function Jt(t,r){var n=r[0]-t[0],e=r[1]-t[1];return n*n+e*e}function $t(t){var r=t[0],n=t[1];return Math.sqrt(r*r+n*n)}function tr(t){var r=t[0],n=t[1];return r*r+n*n}function rr(t,r){return t[0]=-r[0],t[1]=-r[1],t}function nr(t,r){return t[0]=1/r[0],t[1]=1/r[1],t}function er(t,r){var n=r[0],e=r[1],a=n*n+e*e;return a>0&&(a=1/Math.sqrt(a),t[0]=r[0]*a,t[1]=r[1]*a),t}function ar(t,r){return t[0]*r[0]+t[1]*r[1]}function ir(t,r,n){var e=r[0]*n[1]-r[1]*n[0];return t[0]=t[1]=0,t[2]=e,t}function or(t,r,n,e){var a=r[0],i=r[1];return t[0]=a+e*(n[0]-a),t[1]=i+e*(n[1]-i),t}function ur(t,r){r=r||1;var n=2*c()*Math.PI;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t}function sr(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[2]*a,t[1]=n[1]*e+n[3]*a,t}function cr(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[2]*a+n[4],t[1]=n[1]*e+n[3]*a+n[5],t}function fr(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[3]*a+n[6],t[1]=n[1]*e+n[4]*a+n[7],t}function lr(t,r,n){var e=r[0],a=r[1];return t[0]=n[0]*e+n[4]*a+n[12],t[1]=n[1]*e+n[5]*a+n[13],t}function hr(t,r,n,e){var a=r[0]-n[0],i=r[1]-n[1],o=Math.sin(e),u=Math.cos(e);return t[0]=a*u-i*o+n[0],t[1]=a*o+i*u+n[1],t}function dr(t,r){var n=t[0],e=t[1],a=r[0],i=r[1],o=n*n+e*e;o>0&&(o=1/Math.sqrt(o));var u=a*a+i*i;u>0&&(u=1/Math.sqrt(u));var s=(n*a+e*i)*o*u;return s>1?0:s<-1?Math.PI:Math.acos(s)}function vr(t){return"vec2("+t[0]+", "+t[1]+")"}function pr(t,r){return t[0]===r[0]&&t[1]===r[1]}function mr(t,r){var n=t[0],e=t[1],a=r[0],i=r[1];return Math.abs(n-a)<=u*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(e-i)<=u*Math.max(1,Math.abs(e),Math.abs(i))}var xr,br=$t,yr=Gt,Mr=qt,Er=Ht,Tr=Kt,gr=Jt,Rr=tr,Ar=(xr=Ot(),function(t,r,n,e,a,i){var o,u=void 0;for(r||(r=2),n||(n=0),o=e?Math.min(e*r+n,t.length):t.length,u=n;u<o;u+=r)xr[0]=t[u],xr[1]=t[u+1],a(xr,xr,i),t[u]=xr[0],t[u+1]=xr[1];return t});function Fr(){var t=new s(3);return s!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Sr(t){var r=new s(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function wr(t){var r=t[0],n=t[1],e=t[2];return Math.sqrt(r*r+n*n+e*e)}function _r(t,r,n){var e=new s(3);return e[0]=t,e[1]=r,e[2]=n,e}function Dr(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Br(t,r,n,e){return t[0]=r,t[1]=n,t[2]=e,t}function Ur(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t}function Ir(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t}function Cr(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t[2]=r[2]*n[2],t}function Or(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t[2]=r[2]/n[2],t}function Pr(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function Nr(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function zr(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t[2]=Math.min(r[2],n[2]),t}function Lr(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t[2]=Math.max(r[2],n[2]),t}function Xr(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function Gr(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t}function qr(t,r,n,e){return t[0]=r[0]+n[0]*e,t[1]=r[1]+n[1]*e,t[2]=r[2]+n[2]*e,t}function Hr(t,r){var n=r[0]-t[0],e=r[1]-t[1],a=r[2]-t[2];return Math.sqrt(n*n+e*e+a*a)}function jr(t,r){var n=r[0]-t[0],e=r[1]-t[1],a=r[2]-t[2];return n*n+e*e+a*a}function Yr(t){var r=t[0],n=t[1],e=t[2];return r*r+n*n+e*e}function Vr(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function Wr(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function kr(t,r){var n=r[0],e=r[1],a=r[2],i=n*n+e*e+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i),t}function Qr(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function Zr(t,r,n){var e=r[0],a=r[1],i=r[2],o=n[0],u=n[1],s=n[2];return t[0]=a*s-i*u,t[1]=i*o-e*s,t[2]=e*u-a*o,t}function Kr(t,r,n,e){var a=r[0],i=r[1],o=r[2];return t[0]=a+e*(n[0]-a),t[1]=i+e*(n[1]-i),t[2]=o+e*(n[2]-o),t}function Jr(t,r,n,e,a,i){var o=i*i,u=o*(2*i-3)+1,s=o*(i-2)+i,c=o*(i-1),f=o*(3-2*i);return t[0]=r[0]*u+n[0]*s+e[0]*c+a[0]*f,t[1]=r[1]*u+n[1]*s+e[1]*c+a[1]*f,t[2]=r[2]*u+n[2]*s+e[2]*c+a[2]*f,t}function $r(t,r,n,e,a,i){var o=1-i,u=o*o,s=i*i,c=u*o,f=3*i*u,l=3*s*o,h=s*i;return t[0]=r[0]*c+n[0]*f+e[0]*l+a[0]*h,t[1]=r[1]*c+n[1]*f+e[1]*l+a[1]*h,t[2]=r[2]*c+n[2]*f+e[2]*l+a[2]*h,t}function tn(t,r){r=r||1;var n=2*c()*Math.PI,e=2*c()-1,a=Math.sqrt(1-e*e)*r;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=e*r,t}function rn(t,r,n){var e=r[0],a=r[1],i=r[2],o=n[3]*e+n[7]*a+n[11]*i+n[15];return o=o||1,t[0]=(n[0]*e+n[4]*a+n[8]*i+n[12])/o,t[1]=(n[1]*e+n[5]*a+n[9]*i+n[13])/o,t[2]=(n[2]*e+n[6]*a+n[10]*i+n[14])/o,t}function nn(t,r,n){var e=r[0],a=r[1],i=r[2];return t[0]=e*n[0]+a*n[3]+i*n[6],t[1]=e*n[1]+a*n[4]+i*n[7],t[2]=e*n[2]+a*n[5]+i*n[8],t}function en(t,r,n){var e=n[0],a=n[1],i=n[2],o=n[3],u=r[0],s=r[1],c=r[2],f=a*c-i*s,l=i*u-e*c,h=e*s-a*u,d=a*h-i*l,v=i*f-e*h,p=e*l-a*f,m=2*o;return f*=m,l*=m,h*=m,d*=2,v*=2,p*=2,t[0]=u+f+d,t[1]=s+l+v,t[2]=c+h+p,t}function an(t,r,n,e){var a=[],i=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(e)-a[2]*Math.sin(e),i[2]=a[1]*Math.sin(e)+a[2]*Math.cos(e),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function on(t,r,n,e){var a=[],i=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],i[0]=a[2]*Math.sin(e)+a[0]*Math.cos(e),i[1]=a[1],i[2]=a[2]*Math.cos(e)-a[0]*Math.sin(e),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function un(t,r,n,e){var a=[],i=[];return a[0]=r[0]-n[0],a[1]=r[1]-n[1],a[2]=r[2]-n[2],i[0]=a[0]*Math.cos(e)-a[1]*Math.sin(e),i[1]=a[0]*Math.sin(e)+a[1]*Math.cos(e),i[2]=a[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function sn(t,r){var n=_r(t[0],t[1],t[2]),e=_r(r[0],r[1],r[2]);kr(n,n),kr(e,e);var a=Qr(n,e);return a>1?0:a<-1?Math.PI:Math.acos(a)}function cn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function fn(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function ln(t,r){var n=t[0],e=t[1],a=t[2],i=r[0],o=r[1],s=r[2];return Math.abs(n-i)<=u*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(e-o)<=u*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(a-s)<=u*Math.max(1,Math.abs(a),Math.abs(s))}var hn=Ir,dn=Cr,vn=Or,pn=Hr,mn=jr,xn=wr,bn=Yr,yn=function(){var t=Fr();return function(r,n,e,a,i,o){var u,s=void 0;for(n||(n=3),e||(e=0),u=a?Math.min(a*n+e,r.length):r.length,s=e;s<u;s+=n)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],i(t,t,o),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2];return r}}();n.d(r,"a",function(){return e}),n.d(r,"b",function(){return a}),n.d(r,"c",function(){return i}),n.d(r,"d",function(){return o})},40:function(t,r){t.exports='Copyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.'},43:function(t,r){t.exports="precision mediump float;\n\nvarying vec4 color;\n\nvoid main(void) {\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}\n"},44:function(t,r){t.exports="attribute vec3 position;\nattribute vec4 extra;\n\nuniform mat4 projection;\n\nvarying vec4 color;\n\nvoid main(void) {\n  gl_Position = projection * vec4(position, 1.0);\n  color = extra;\n}\n"},45:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D fb;\nuniform sampler2D hilights;\nuniform vec2 separation[3];\nvarying vec2 texCoord;\nvarying vec2 hi_texCoord;\n\nvec3 sep(in sampler2D tex, in vec2 uv) {\n  float red = texture2D(tex, uv + separation[0]).r;\n  float green = texture2D(tex, uv + separation[1]).g;\n  float blue = texture2D(tex, uv + separation[2]).b;\n  return vec3(red, green, blue);\n}\n\nvoid main(void) {\n  vec3 color = sep(fb, texCoord);\n  vec3 bloom = sep(hilights, hi_texCoord);\n  gl_FragColor = vec4(color + bloom * 0.5, 1.0);\n}\n"},46:function(t,r){t.exports="attribute vec2 position;\n\nvarying vec2 texCoord;\nvarying vec2 hi_texCoord;\nuniform vec2 fbScale;\nuniform vec2 hilightsScale;\n\nvoid main(void) {\n  gl_Position = vec4(position, 0.0, 1.0);\n  texCoord = (position * 0.5 + 0.5) * fbScale;\n  hi_texCoord = (position * 0.5 + 0.5) * hilightsScale;\n}\n"},47:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D fb;\nvarying vec2 texCoord;\n\nvoid main(void) {\n  vec3 color = texture2D(fb, texCoord).rgb;\n  float brightness = dot(color, vec3(0.2126, 0.7152, 0.0722));\n  if (brightness > 0.5) {\n    gl_FragColor = vec4(color, 1.0);\n  } else {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n  }\n}\n"},48:function(t,r){t.exports="attribute vec2 position;\n\nvarying vec2 texCoord;\nuniform vec2 fbScale;\n\nvoid main(void) {\n  gl_Position = vec4(position, 0.0, 1.0);\n  texCoord = (position * 0.5 + 0.5) * fbScale;\n}\n"},49:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D fb;\nuniform vec2 pixelSize;\nvarying vec2 texCoord;\n\nuniform float blurWeights[KSIZE];\nuniform vec2 blurVector;\n\nvoid main(void) {\n  vec3 blur = texture2D(fb, texCoord).rgb * blurWeights[0];\n  for (int i = 1; i < KSIZE; i++) {\n    vec2 v = vec2(pixelSize * float(i) * blurVector);\n    float w = blurWeights[i];\n    blur += texture2D(fb, texCoord + v).rgb * w;\n    blur += texture2D(fb, texCoord - v).rgb * w;\n  }\n  gl_FragColor = vec4(blur, 1.0);\n}\n"},50:function(t,r){t.exports="attribute vec2 position;\n\nvarying vec2 texCoord;\nuniform vec2 fbScale;\n\nvoid main(void) {\n  gl_Position = vec4(position, 0.0, 1.0);\n  texCoord = (position * 0.5 + 0.5) * fbScale;\n}\n"},51:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D sampler;\nvarying vec4 texCoord;\n\nvoid main(void) {\n  vec4 color = texture2D(sampler, texCoord.st);\n  color.a *= texCoord.q;\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}\n"},52:function(t,r){t.exports="attribute vec3 position;\nattribute vec4 extra;\n\nuniform mat4 projection;\nvarying vec4 texCoord;\n\nvoid main(void) {\n  gl_Position = projection * vec4(position, 1.0);\n  texCoord = extra;\n}\n"},53:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D sampler;\nvarying vec4 texCoord;\n\nvoid main(void) {\n  vec4 color = texture2D(sampler, texCoord.st);\n  color.a *= texCoord.q;\n  if (color.a == 0.0) discard;\n  float light = texCoord.p;\n  color = vec4(color.rgb * light, color.a);\n  gl_FragColor = color;\n}\n"},54:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D sampler;\nuniform sampler2D screenSampler;\nuniform vec4 screenTexBounds;\nuniform float alpha;\nvarying vec4 texCoord;\n\nvoid main(void) {\n  vec4 texColor = texture2D(sampler, texCoord.st);\n  vec2 midpoint = (screenTexBounds.xy + screenTexBounds.zw) / 2.0;\n  vec2 uv = midpoint + (texCoord.pq - midpoint) / 1.5;\n  vec4 screenColor = texture2D(screenSampler, uv);\n  gl_FragColor = vec4(mix(screenColor.rgb, texColor.rgb, texColor.a * alpha), 1.0);\n}\n"},55:function(t,r){t.exports="precision mediump float;\n\nuniform sampler2D screenSampler;\nuniform vec4 screenTexBounds;\nuniform float thickness;\nuniform float depth;\nuniform float curve;\nuniform mat3 transform;\n\nvarying vec4 texCoord;\n\nvoid main(void) {\n  vec2 uv = texCoord.pq;\n  float borderWidth = thickness / 4.0;\n  float radius = 0.5 - borderWidth;\n  vec2 qsize = screenTexBounds.zw - screenTexBounds.xy;\n  vec2 midpoint = (screenTexBounds.xy + screenTexBounds.zw) / 2.0;\n  vec2 rv = (transform * vec3((uv - midpoint) / qsize, 1.0)).xy;\n  float d = abs(length(rv) - radius);\n  if (d < borderWidth) {\n    float cr = d / borderWidth;\n    vec2 dpoint = normalize(rv) * radius;\n    uv += (rv - dpoint) * sqrt(1.0 - pow(cr, 4.0)) * depth;\n  }\n  gl_FragColor = texture2D(screenSampler, uv);\n}\n"},56:function(t,r){t.exports="precision mediump float;\n\nuniform vec2 fbSize;\nuniform sampler2D sampler;\nuniform vec4 screenTexBounds;\nuniform float phase;\nvarying vec4 texCoord;\nvarying vec2 fbPosition;\n\nconst float PI = 3.141592653589793;\n\nvoid main(void) {\n  float ystep = (fbPosition.y - screenTexBounds.y) /\n    (screenTexBounds.w - screenTexBounds.y) + phase;\n  vec2 uv = texCoord.st + vec2(sin(ystep * PI * 2.0) * 6.0/fbSize.x, 0.0);\n  gl_FragColor = texture2D(sampler, uv);\n}\n"},79:function(t,r){t.exports=function(t,r){if(null==t)return{};var n,e,a={},i=Object.keys(t);for(e=0;e<i.length;e++)n=i[e],r.indexOf(n)>=0||(a[n]=t[n]);return a}}}]);